<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NOVACORE</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#0b1220;
  color:white;
  text-align:center;
}
input,button{
  padding:12px;
  margin:6px;
  border-radius:6px;
  border:none;
  width:80%;
  max-width:400px;
}
button{
  background:#3b82f6;
  color:white;
  font-weight:bold;
}
#chart{
  height:350px;
  width:100%;
}
table{
  width:95%;
  margin:auto;
  border-collapse:collapse;
}
td,th{
  border:1px solid #333;
  padding:6px;
}
.hidden{display:none;}
</style>
</head>

<body>

<!-- LOGIN PAGE -->
<div id="loginPage">
<h2>NOVACORE</h2>

<input id="username" placeholder="Username"><br>
<input id="password" type="password" placeholder="Password"><br>

<button onclick="login()">Login</button>
<button onclick="register()">Register</button>
</div>

<!-- TRADING PAGE -->
<div id="appPage" class="hidden">

<h2>ZenTrade Pro</h2>
<button onclick="logout()">Logout</button>

<h3>Wallet: â‚¹ <span id="balance"></span></h3>

<input id="symbolInput" value="NASDAQ:AAPL"><br>
<button onclick="loadChart()">Show Chart</button>

<div id="chart"></div>

<input id="qty" type="number" placeholder="Quantity"><br>
<button onclick="trade('BUY')">Buy</button>
<button onclick="trade('SELL')">Sell</button>

<h3>Trade History</h3>
<table>
<thead>
<tr><th>Type</th><th>Symbol</th><th>Qty</th><th>Time</th></tr>
</thead>
<tbody id="history"></tbody>
</table>

</div>

<script src="https://s3.tradingview.com/tv.js"></script>

<script>
let balance = localStorage.getItem("balance") || 100000;
let trades = JSON.parse(localStorage.getItem("trades")) || [];

function saveData(){
  localStorage.setItem("balance", balance);
  localStorage.setItem("trades", JSON.stringify(trades));
}

function register(){
  const u = username.value;
  const p = password.value;
  localStorage.setItem("user", JSON.stringify({u,p}));
  alert("Registered! Now login.");
}

function login(){
  const stored = JSON.parse(localStorage.getItem("user"));
  if(!stored) return alert("Register first");

  if(username.value === stored.u &&
     password.value === stored.p){
      loginPage.classList.add("hidden");
      appPage.classList.remove("hidden");
      updateUI();
      loadChart();
  } else alert("Wrong login");
}

function logout(){
  location.reload();
}

function updateUI(){
  balanceEl = document.getElementById("balance");
  balanceEl.innerText = balance;

  history.innerHTML="";
  trades.slice().reverse().forEach(t=>{
    history.innerHTML +=
    `<tr>
      <td>${t.type}</td>
      <td>${t.symbol}</td>
      <td>${t.qty}</td>
      <td>${t.time}</td>
    </tr>`;
  });
}

function trade(type){
  const symbol = symbolInput.value;
  const qty = qtyInput = qty.value;

  if(!qtyInput) return alert("Enter quantity");

  trades.push({
    type,
    symbol,
    qty: qtyInput,
    time: new Date().toLocaleString()
  });

  saveData();
  updateUI();
}

function loadChart(){
  chart.innerHTML = "";

  new TradingView.widget({
    container_id: "chart",
    autosize: true,
    symbol: symbolInput.value,
    interval: "D",
    theme: "dark",
    locale: "en"
  });
}
</script>

</body>
</html>
